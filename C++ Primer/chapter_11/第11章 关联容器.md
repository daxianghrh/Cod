# 第11章 关联容器

**关联容器**中的元素是按**关键字**来保存和访问。

两个主要的关联容器：
- 1、**map**容器中元素是以关键字-值对(key-value)的形式存在的。关键字起到索引的作用，值则表示与索引相关联的数据。
- 2、**set**容器中元素只包含一个关键字，关键字即值。set容器支持高效的关键字查询操作——检查一个关键字是否在set中。

标准库提供8个关联容器，8个容器间的不同体现在三个维度上：
- 1、或是set，或是map
- 2、或者要求不重复的关键字，或者允许重复关键字。**允许重复关键字的容器的名字都包含multi**
- 3、或按顺序保存元素，或无序保存。**允许关键字无序保存的容器的名字都是以unordered开头**
  
## 11.2 关联容器概述

### 11.2.2 关键字类型的要求

关联容器中的关键字类型必须定义元素比较的方法，默认使用<运算符来比较两个关键词。

#### 使用关键字类型的比较函数

用来组织一个容器中元素的操作类型也是该容器类型的一部分。为了指定使用自定义的操作，必须在定义关联容器类型时提供此操作的类型。**用尖括号指出要定义哪种类型的容器，自定义的操作类型必须在尖括号中紧跟着元素类型给出**。

```cpp
bool compareIsbn(const Sale_data &lhs, const Sale_data &rhs)
{
    return lhs.isbn() < rhs.isbn();
}
```

在定义multiset时必须提供两个类型：关键字类型Sale_data，以及比较操作类型(应该是函数指针类型)。

```cpp
multiset<Sale_data, decltype(compareIsbn)*> bookstore(compareIsbn);
```

### 11.2.3 pair类型

**pair**标准库类型，定义在utility头文件中。

## 11.3 关联容器操作

关联容器额外的类型别名：**key_value**,**mapped_type**,**value_type**。

### 11.3.1 关联容器迭代器

解引用一个关联容器迭代器时，得到一个类型为容器的value_type的值的引用。

**注：一个map的value_type是一个pair，可以改变pair的值，但不能改变关键字成员的值(const)。**

#### set的迭代器是const

只允许只读访问set中的元素。

### 11.3.2 添加元素

insert成员向容器中添加一个元素或一个元素范围。

对一个map进行insert操作时，必须记住元素类型是pair。

### 11.3.3 删除元素

erase成员有三个版本：接受一个迭代器或一对迭代器或**接受一个key_value参数，删除所有给定关键字的元素，返回实际删除的元素的数量**

### 11.3.4 map的下标操作

map和unordered_map容器提供了下标运算符和一个对应的at函数；set类型容器不支持下标；multimap和unordered_multimap不支持下标操作。

